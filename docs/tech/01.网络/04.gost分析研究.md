---
title: gost 的研究
date: 2022-08-30 19:47:32
permalink: /tech/net/gost/
article: false
---

# 概念理解

## Service

每个服务包含一个监听器(Listener)和一个处理器(Handler)。

理解为入站。

## Node

每个节点包含一个拨号器(Dialer)和一个连接器(Connector)。

## 监听器(Listener)
监听器在本地打开指定的端口，负责数据的收发及数据通道的建立和初始化工作(例如加解密，会话和数据流通道初始化等)，与客户端进行直接的数据交互。

## 处理器(Handler)
处理器是监听器上的一个逻辑抽象层，当监听器建立好数据通道之后，客户端的实际请求数据会交给处理器进行处理，其中包括路由判断，域名解析，权限控制等处理逻辑。


## 主要流程
                          
           accept()                                                dial()
Listener -------------> Handler --------> Route -------> Dialer ----------->  HandShake -----> Connector 
   |                      |                                |                     |
    ------- service ------                                  --------- node -------

## 缺陷
+ 有些臃肿、启动速度慢。
+ 多余功能不太需要，如 post-up 这种带有危险 exec 行为的地方，一旦开始集成以后很容易忘记导致配置错误的 rce 注入。
+ 认证部分在函数场景可以通过触发器来实现，比网络请求的auth更实惠好用（因为403不计费）。
+ 没有版本控制(最开始想引用core....但是没tag，有点慌，最终还是算了)